<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registered Members PDF</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #333;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    #filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
    }
    select, button {
      padding: 6px;
      font-size: 14px;
    }
    @media print {
      #filters, button {
        display: none;
      }
    }
  button {
  background-color: #007BFF;
  color: #fff;
  padding: 10px 18px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  margin-right: 10px;
  box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #0056b3;
}
  </style>
</head>
<body>

  <h2>Registered Members List</h2>

  <div id="filters">
    <select id="filterLGA">
      <option value="">Filter by LGA</option>
    </select>
    <select id="filterWard">
      <option value="">Filter by Ward</option>
    </select>
    <select id="filterUnit">
      <option value="">Filter by Polling Unit</option>
    </select>
    <button onclick="applyFilters()" style="background-color: blue; color: white;">Apply Filter</button>
    <button onclick="resetFilters()" style="background-color: orange; color: white;">Reset</button>
    <button onclick="downloadPDF()" style="background-color: green; color: white;">‚¨áÔ∏è Download PDF (Landscape)</button>
    <button onclick="location.href='index.html'" style="background-color: black; color: white;">üîô Back to Registration</button>
  </div>

  <table id="members-table">
    <thead>
      <tr>
        <th>SN</th>
        <th>Full Name</th>
        <th>DOB</th>
        <th>Age</th>
        <th>Phone</th>
        <th>LGA</th>
        <th>Ward</th>
        <th>Polling Unit</th>
        <th>VIN</th>
        <th>Party ID</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.30/jspdf.plugin.autotable.min.js"></script>

  <script>
    const members = JSON.parse(localStorage.getItem('members') || '[]');
    const tbody = document.querySelector('#members-table tbody');
    const filterLGA = document.getElementById('filterLGA');
    const filterWard = document.getElementById('filterWard');
    const filterUnit = document.getElementById('filterUnit');

    const unique = (arr, key) => [...new Set(arr.map(obj => obj[key]).filter(Boolean))];

    function populateDropdowns() {
      unique(members, 'lga').forEach(lga => {
        const opt = document.createElement('option');
        opt.textContent = opt.value = lga;
        filterLGA.appendChild(opt);
      });
      unique(members, 'ward').forEach(ward => {
        const opt = document.createElement('option');
        opt.textContent = opt.value = ward;
        filterWard.appendChild(opt);
      });
      unique(members, 'unit').forEach(unit => {
        const opt = document.createElement('option');
        opt.textContent = opt.value = unit;
        filterUnit.appendChild(opt);
      });
    }

    function renderTable(data) {
      tbody.innerHTML = '';
      data.forEach((m, i) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${m.fullname}</td>
          <td>${m.dob}</td>
          <td>${m.age}</td>
          <td>${m.phone}</td>
          <td>${m.lga}</td>
          <td>${m.ward}</td>
          <td>${m.unit}</td>
        <td>${m.vin ? m.vin : ''}</td>
<td>${m.partyId ? m.partyId : ''}</td>
          
        `;
        tbody.appendChild(row);
      });
    }

    function applyFilters() {
      const lga = filterLGA.value;
      const ward = filterWard.value;
      const unit = filterUnit.value;

      const filtered = members.filter(m => {
        return (!lga || m.lga === lga) &&
               (!ward || m.ward === ward) &&
               (!unit || m.unit === unit);
      });

      renderTable(filtered);
    }

    function resetFilters() {
      filterLGA.value = '';
      filterWard.value = '';
      filterUnit.value = '';
      renderTable(members);
    }

    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'landscape' });

      doc.text("Registered Members", 14, 15);
      const data = [...document.querySelectorAll('#members-table tbody tr')].map(tr =>
        [...tr.children].map(td => td.textContent)
      );

      doc.autoTable({
        head: [['#', 'Full Name', 'DOB', 'Age', 'Phone', 'LGA', 'Ward', 'Polling Unit', 'VIN', 'Party ID']],
        body: data,
        startY: 20
      });

      doc.save("Registered_Members_List.pdf");
    }

    // Load
    window.onload = () => {
      if (members.length === 0) {
        alert("No registered members found.");
        return;
      }
      populateDropdowns();
      renderTable(members);
      window.print(); // Optional: auto print on load
    };
  </script>
</body>
</html>






<!--
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registered Members PDF</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #333;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    @media print {
      button {
        display: none;
      }
    }
  </style>
</head>
<body>
  <h2>Registered Members List</h2>
  <table id="members-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Full Name</th>
        <th>DOB</th>
        <th>Age</th>
        <th>Phone</th>
        <th>LGA</th>
        <th>Ward</th>
        <th>Polling Unit</th>
        <th>VIN</th>
        <th>Party ID</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
<button onclick="downloadPDF()" style="margin-top: 20px; background-color: green; color: white; padding: 10px 16px; border: none; border-radius: 5px; cursor: pointer;">
      ‚¨áÔ∏è Download PDF (Landscape)
    </button>
   <!-- AutoTable plugin for jsPDF --
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.30/jspdf.plugin.autotable.min.js"></script>

  <script>
    // Load members from localStorage
    const members = JSON.parse(localStorage.getItem('members') || '[]');
    const tableBody = document.querySelector('#members-table tbody');

    members.forEach((m, i) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${i + 1}</td>
        <td>${m.fullname}</td>
        <td>${m.dob}</td>
        <td>${m.age}</td>
        <td>${m.phone}</td>
        <td>${m.lga}</td>
        <td>${m.ward}</td>
        <td>${m.unit}</td>
        <td>${m.vin || ''}</td>
        <td>${m.partyId || ''}</td>
      `;
      tableBody.appendChild(row);
    });

    // Trigger print when loaded
    window.onload = () => {
      if (members.length === 0) {
        alert("No registered members found in localStorage.");
      } else {
        window.print();
      }
    };
  </script>
</body>
</html>
